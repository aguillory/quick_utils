<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health & Medical Records - Farm Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/health.css">
</head>
<body>
    <div id="global-nav"></div>

<main class="health-container">
        <header class="page-header">
    <div class="header-content">
        <h1><i class="fas fa-heartbeat"></i> Health & Medical Records</h1>
        <p class="subtitle">Track health events, schedule tasks, and monitor withdrawals</p>
    </div>
    <div class="header-actions">
        <button class="btn-primary" id="btnMedCalculator">
            <i class="fas fa-calculator"></i> Med Calc (external)
        </button>
        <button class="btn-secondary" id="btnScheduleTask">
            <i class="fas fa-calendar-plus"></i> Schedule Task
        </button>
        <button class="btn-primary" id="btnAddRecord">
            <i class="fas fa-plus"></i> Add Record
        </button>
        <button class="btn-primary" id="btnBulkAction">
            <i class="fas fa-users"></i> Bulk Action
        </button>
    </div>
</header>

<!-- Dashboard Controls -->
<div class="dashboard-controls">
    <div class="dashboard-toggle">
        <input type="checkbox" id="dashboardFarmToggle">
        <label for="dashboardFarmToggle">
            <i class="fas fa-globe"></i> Show all animals across farms
        </label>
    </div>
</div>

        <!-- Alerts Section -->
        <section class="alerts-section">
            <h2 class="section-title"><i class="fas fa-exclamation-triangle"></i> Alerts & Attention Needed</h2>
            <div class="alerts-grid" id="alertsGrid">
                <!-- Alert cards will be populated here -->
                <div class="alert-card alert-loading">
                    <i class="fas fa-spinner fa-spin"></i> Loading alerts...
                </div>
            </div>
        </section>

        <!-- Quick Stats Dashboard -->
        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-card" id="statActiveIssues">
                    <div class="stat-icon danger">
                        <i class="fas fa-notes-medical"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number">-</span>
                        <span class="stat-label">Active Issues</span>
                    </div>
                </div>
                <div class="stat-card" id="statInWithdrawal">
                    <div class="stat-icon warning">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number">-</span>
                        <span class="stat-label">In Withdrawal</span>
                    </div>
                </div>
                <div class="stat-card" id="statDueToday">
                    <div class="stat-icon primary">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number">-</span>
                        <span class="stat-label">Due Today</span>
                    </div>
                </div>
                <div class="stat-card" id="statOverdue">
                    <div class="stat-icon danger">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number">-</span>
                        <span class="stat-label">Overdue</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Main Content Grid -->
        <div class="main-content-grid">
            <!-- Schedule Section -->
            <section class="schedule-section card">
                <div class="section-header">
                    <h2><i class="fas fa-calendar-alt"></i> Scheduled Tasks</h2>
                    <div class="section-filters">
                        <select id="scheduleFilter" class="filter-select">
                            <option value="all">All Tasks</option>
                            <option value="overdue">Overdue</option>
                            <option value="today">Due Today</option>
                            <option value="week">This Week</option>
                            <option value="undated">Undated</option>
                        </select>
                    </div>
                </div>
                <div class="tasks-list" id="tasksList">
                    <div class="loading-placeholder">
                        <i class="fas fa-spinner fa-spin"></i> Loading tasks...
                    </div>
                </div>
            </section>

            <!-- Recent Records Section -->
            <section class="records-section card">
                <div class="section-header">
                    <h2><i class="fas fa-history"></i> Recent Records</h2>
                    <div class="section-filters">
                        <select id="recordsSpeciesFilter" class="filter-select">
                            <option value="all">All Species</option>
                        </select>
                        <select id="recordsTypeFilter" class="filter-select">
                            <option value="all">All Types</option>
                        </select>
                    </div>
                </div>
                <div class="records-list" id="recordsList">
                    <div class="loading-placeholder">
                        <i class="fas fa-spinner fa-spin"></i> Loading records...
                    </div>
                </div>
                <div class="section-footer">
                    <button class="btn-text" id="btnViewAllRecords">
                        View All Records <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </section>
        </div>

        <!-- Withdrawal Tracking Section -->
        <section class="withdrawal-section card">
            <div class="section-header">
                <h2><i class="fas fa-ban"></i> Active Withdrawals</h2>
                <div class="withdrawal-legend">
                    <span class="legend-item"><i class="fas fa-drumstick-bite"></i> Meat</span>
                    <span class="legend-item"><i class="fas fa-cheese"></i> Dairy</span>
                    <span class="legend-item"><i class="fas fa-egg"></i> Eggs</span>
                </div>
            </div>
            <div class="withdrawal-list" id="withdrawalList">
                <div class="loading-placeholder">
                    <i class="fas fa-spinner fa-spin"></i> Loading withdrawals...
                </div>
            </div>
        </section>
    </main>

    <!-- Add/Edit Health Record Modal -->
    <div id="recordModal" class="modal">
        <div class="modal-content modal-large">
            <span class="modal-close" data-modal="recordModal">&times;</span>
            <h2 id="recordModalTitle"><i class="fas fa-notes-medical"></i> Add Health Record</h2>
            <form id="recordForm">
                <input type="hidden" id="recordId">
                <input type="hidden" id="recordLinkedTaskId">
                
                <!-- Animal Selection with Search and Filter -->
                <div class="animal-selector">
                    <label><strong>Select Animal *</strong></label>
                    <div class="animal-selector-header">
                        <div class="form-group">
                            <input type="text" id="recordAnimalSearch" placeholder="Search by name or tag...">
                        </div>
                        <div class="form-group">
                            <select id="recordAnimalSpeciesFilter">
                                <option value="all">All Species</option>
                            </select>
                        </div>
                    </div>
                    <div class="farm-toggle">
                        <input type="checkbox" id="recordAnimalFarmToggle">
                        <label for="recordAnimalFarmToggle">Show animals from all farms</label>
                    </div>
                    <select id="recordAnimal" required>
                        <option value="">Select an animal...</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="recordEventType">Event Type *</label>
                        <select id="recordEventType" required>
                            <option value="">Select type...</option>
                            <option value="Vaccination">Vaccination</option>
                            <option value="Deworming">Deworming</option>
                            <option value="Hoof/Foot Trimming">Hoof/Foot Trimming</option>
                            <option value="Disbudding/Dehorning">Disbudding/Dehorning</option>
                            <option value="Banding/Castration">Banding/Castration</option>
                            <option value="Shearing/Grooming">Shearing/Grooming</option>
                            <option value="Veterinary Visit">Veterinary Visit</option>
                            <option value="Illness/Injury">Illness/Injury</option>
                            <option value="Surgery">Surgery</option>
                            <option value="Dental Care">Dental Care</option>
                            <option value="Fecal Test">Fecal Test</option>
                            <option value="Blood Test">Blood Test</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="recordDate">Date *</label>
                        <input type="date" id="recordDate" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="recordStatus">Status</label>
                        <select id="recordStatus">
                            <option value="completed">Completed</option>
                            <option value="ongoing">Ongoing (Active Issue)</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="recordDescription">Description</label>
                    <input type="text" id="recordDescription" placeholder="Brief description of the event">
                </div>

                <!-- Medication/Treatment Section -->
                <div class="form-section collapsible" id="medicationSection">
                    <div class="section-toggle" data-target="medicationFields">
                        <i class="fas fa-pills"></i> Medication/Treatment Details
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="section-fields" id="medicationFields">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="recordMedication">Medication/Vaccine Name</label>
                                <input type="text" id="recordMedication" placeholder="e.g., Ivermectin, CDT Vaccine">
                            </div>
                            <div class="form-group">
                                <label for="recordDosage">Dosage</label>
                                <input type="text" id="recordDosage" placeholder="e.g., 1ml per 50lbs">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="recordAdministeredBy">Administered By</label>
                                <input type="text" id="recordAdministeredBy" placeholder="Self, Vet name, etc.">
                            </div>
                            <div class="form-group">
                                <label for="recordLotNumber">Lot/Batch Number</label>
                                <input type="text" id="recordLotNumber" placeholder="Optional tracking">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Withdrawal Section -->
                <div class="form-section collapsible" id="withdrawalSection">
                    <div class="section-toggle" data-target="withdrawalFields">
                        <i class="fas fa-clock"></i> Withdrawal Periods
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="section-fields" id="withdrawalFields">
                        <p class="field-help">Enter the number of days for each withdrawal period (leave blank if none)</p>
                        <div class="form-row three-col">
                            <div class="form-group">
                                <label for="withdrawalMeat">
                                    <i class="fas fa-drumstick-bite"></i> Meat (days)
                                </label>
                                <input type="number" id="withdrawalMeat" min="0" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label for="withdrawalDairy">
                                    <i class="fas fa-cheese"></i> Dairy (days)
                                </label>
                                <input type="number" id="withdrawalDairy" min="0" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label for="withdrawalEggs">
                                    <i class="fas fa-egg"></i> Eggs (days)
                                </label>
                                <input type="number" id="withdrawalEggs" min="0" placeholder="0">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Follow-up Section -->
                <div class="form-section collapsible" id="followupSection">
                    <div class="section-toggle" data-target="followupFields">
                        <i class="fas fa-redo"></i> Schedule Follow-up
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="section-fields" id="followupFields">
                        <div class="form-group checkbox-group">
                            <label>
                                <input type="checkbox" id="recordScheduleFollowup">
                                Schedule a follow-up task
                            </label>
                        </div>
                        <div id="followupDetails" class="hidden">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="followupDate">Follow-up Date</label>
                                    <input type="date" id="followupDate">
                                </div>
                                <div class="form-group">
                                    <label for="followupNotes">Follow-up Notes</label>
                                    <input type="text" id="followupNotes" placeholder="e.g., Booster shot needed">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Info -->
                <div class="form-section collapsible" id="additionalSection">
                    <div class="section-toggle" data-target="additionalFields">
                        <i class="fas fa-info-circle"></i> Additional Information
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="section-fields" id="additionalFields">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="recordVeterinarian">Veterinarian</label>
                                <input type="text" id="recordVeterinarian" placeholder="Vet name/clinic">
                            </div>
                            <div class="form-group">
                                <label for="recordCost">Cost ($)</label>
                                <input type="number" id="recordCost" min="0" step="0.01" placeholder="0.00">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="recordNotes">Notes</label>
                            <textarea id="recordNotes" rows="3" placeholder="Additional notes or observations..."></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" data-modal="recordModal">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Save Record
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Schedule Task Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content modal-large">
            <span class="modal-close" data-modal="taskModal">&times;</span>
            <h2 id="taskModalTitle"><i class="fas fa-calendar-plus"></i> Schedule Health Task</h2>
            <form id="taskForm">
                <input type="hidden" id="taskId">
                <input type="hidden" id="taskLinkedRecordId">

                <!-- Animal Selection with Search and Filter -->
                <div class="animal-selector">
                    <label><strong>Select Animal *</strong></label>
                    <div class="animal-selector-header">
                        <div class="form-group">
                            <input type="text" id="taskAnimalSearch" placeholder="Search by name or tag...">
                        </div>
                        <div class="form-group">
                            <select id="taskAnimalSpeciesFilter">
                                <option value="all">All Species</option>
                            </select>
                        </div>
                    </div>
                    <div class="farm-toggle">
                        <input type="checkbox" id="taskAnimalFarmToggle">
                        <label for="taskAnimalFarmToggle">Show animals from all farms</label>
                    </div>
                    <select id="taskAnimal" required>
                        <option value="">Select an animal...</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="taskEventType">Event Type *</label>
                        <select id="taskEventType" required>
                            <option value="">Select type...</option>
                            <option value="Vaccination">Vaccination</option>
                            <option value="Deworming">Deworming</option>
                            <option value="Hoof/Foot Trimming">Hoof/Foot Trimming</option>
                            <option value="Disbudding/Dehorning">Disbudding/Dehorning</option>
                            <option value="Banding/Castration">Banding/Castration</option>
                            <option value="Shearing/Grooming">Shearing/Grooming</option>
                            <option value="Veterinary Visit">Veterinary Visit</option>
                            <option value="Illness/Injury">Illness/Injury Check</option>
                            <option value="Surgery">Surgery</option>
                            <option value="Dental Care">Dental Care</option>
                            <option value="Fecal Test">Fecal Test</option>
                            <option value="Blood Test">Blood Test</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Due Date</label>
                        <div class="date-option-group">
                            <label class="radio-label">
                                <input type="radio" name="taskDateOption" value="dated" checked>
                                Specific Date
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="taskDateOption" value="undated">
                                No Specific Date (Needs Done)
                            </label>
                        </div>
                        <input type="date" id="taskDueDate" class="mt-sm">
                    </div>
                    <div class="form-group">
                        <label for="taskPriority">Priority</label>
                        <select id="taskPriority">
                            <option value="low">Low</option>
                            <option value="normal" selected>Normal</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="taskDescription">Description *</label>
                    <input type="text" id="taskDescription" required placeholder="What needs to be done?">
                </div>

                <!-- Pre-fill details for when marking complete -->
                <div class="form-section collapsible" id="taskPrefillSection">
                    <div class="section-toggle" data-target="taskPrefillFields">
                        <i class="fas fa-clipboard-list"></i> Pre-fill Details (for when completed)
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="section-fields" id="taskPrefillFields">
                        <p class="field-help">These details will auto-fill when you mark this task complete</p>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="taskMedication">Medication/Vaccine</label>
                                <input type="text" id="taskMedication" placeholder="e.g., Ivermectin">
                            </div>
                            <div class="form-group">
                                <label for="taskDosage">Dosage</label>
                                <input type="text" id="taskDosage" placeholder="e.g., 1ml per 50lbs">
                            </div>
                        </div>
                        <div class="form-row three-col">
                            <div class="form-group">
                                <label for="taskWithdrawalMeat">
                                    <i class="fas fa-drumstick-bite"></i> Meat Withdrawal
                                </label>
                                <input type="number" id="taskWithdrawalMeat" min="0" placeholder="days">
                            </div>
                            <div class="form-group">
                                <label for="taskWithdrawalDairy">
                                    <i class="fas fa-cheese"></i> Dairy Withdrawal
                                </label>
                                <input type="number" id="taskWithdrawalDairy" min="0" placeholder="days">
                            </div>
                            <div class="form-group">
                                <label for="taskWithdrawalEggs">
                                    <i class="fas fa-egg"></i> Egg Withdrawal
                                </label>
                                <input type="number" id="taskWithdrawalEggs" min="0" placeholder="days">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="taskNotes">Notes</label>
                    <textarea id="taskNotes" rows="2" placeholder="Additional notes..."></textarea>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" data-modal="taskModal">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Save Task
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bulk Action Modal -->
    <div id="bulkModal" class="modal">
        <div class="modal-content modal-xlarge">
            <span class="modal-close" data-modal="bulkModal">&times;</span>
            <h2><i class="fas fa-users"></i> Bulk Health Action</h2>
            
            <div class="bulk-container">
                <!-- Step 1: Select Animals -->
                <div class="bulk-step" id="bulkStep1">
                    <h3>Step 1: Select Animals</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bulkSpeciesFilter">Filter by Species</label>
                            <select id="bulkSpeciesFilter">
                                <option value="all">All Species</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bulkStatusFilter">Filter by Status</label>
                            <select id="bulkStatusFilter">
                                <option value="active">Active Only</option>
                                <option value="all">All Statuses</option>
                            </select>
                        </div>
                    </div>

                    <div class="bulk-select-actions">
                        <button type="button" class="btn-text" id="btnSelectAll">
                            <i class="fas fa-check-double"></i> Select All
                        </button>
                        <button type="button" class="btn-text" id="btnSelectNone">
                            <i class="fas fa-times"></i> Select None
                        </button>
                        <span class="selected-count">0 animals selected</span>
                    </div>

                    <div class="animals-grid" id="bulkAnimalsGrid">
                        <div class="loading-placeholder">
                            <i class="fas fa-spinner fa-spin"></i> Loading animals...
                        </div>
                    </div>

                    <div class="step-actions">
                        <button type="button" class="btn-primary" id="btnBulkNext" disabled>
                            Next: Enter Details <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Enter Details -->
                <div class="bulk-step hidden" id="bulkStep2">
                    <h3>Step 2: Enter Health Record Details</h3>
                    
                    <div class="selected-animals-summary" id="selectedAnimalsSummary">
                        <!-- Will show selected animals -->
                    </div>

                    <form id="bulkForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bulkEventType">Event Type *</label>
                                <select id="bulkEventType" required>
                                    <option value="">Select type...</option>
                                    <option value="Vaccination">Vaccination</option>
                                    <option value="Deworming">Deworming</option>
                                    <option value="Hoof/Foot Trimming">Hoof/Foot Trimming</option>
                                    <option value="Disbudding/Dehorning">Disbudding/Dehorning</option>
                                    <option value="Banding/Castration">Banding/Castration</option>
                                    <option value="Shearing/Grooming">Shearing/Grooming</option>
                                    <option value="Veterinary Visit">Veterinary Visit</option>
                                    <option value="Fecal Test">Fecal Test</option>
                                    <option value="Blood Test">Blood Test</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="bulkRecordType">Record Type *</label>
                                <select id="bulkRecordType" required>
                                    <option value="record">Health Record (Already Done)</option>
                                    <option value="task">Schedule Task (Future)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="bulkDate" id="bulkDateLabel">Date *</label>
                                <input type="date" id="bulkDate" required>
                            </div>
                            <div class="form-group">
                                <label for="bulkDescription">Description</label>
                                <input type="text" id="bulkDescription" placeholder="Brief description">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="bulkMedication">Medication/Vaccine</label>
                                <input type="text" id="bulkMedication" placeholder="e.g., CDT Vaccine">
                            </div>
                            <div class="form-group">
                                <label for="bulkDosage">Dosage</label>
                                <input type="text" id="bulkDosage" placeholder="e.g., 2ml subcutaneous">
                            </div>
                        </div>

                        <div class="form-row three-col">
                            <div class="form-group">
                                <label for="bulkWithdrawalMeat">
                                    <i class="fas fa-drumstick-bite"></i> Meat (days)
                                </label>
                                <input type="number" id="bulkWithdrawalMeat" min="0" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label for="bulkWithdrawalDairy">
                                    <i class="fas fa-cheese"></i> Dairy (days)
                                </label>
                                <input type="number" id="bulkWithdrawalDairy" min="0" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label for="bulkWithdrawalEggs">
                                    <i class="fas fa-egg"></i> Eggs (days)
                                </label>
                                <input type="number" id="bulkWithdrawalEggs" min="0" placeholder="0">
                            </div>
                        </div>

                        <!-- Follow-up for bulk (only for records, not tasks) -->
                        <div id="bulkFollowupSection">
                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="bulkScheduleFollowup">
                                    Schedule follow-up for all selected animals
                                </label>
                            </div>
                            <div id="bulkFollowupDetails" class="hidden">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="bulkFollowupDate">Follow-up Date</label>
                                        <input type="date" id="bulkFollowupDate">
                                    </div>
                                    <div class="form-group">
                                        <label for="bulkFollowupNotes">Follow-up Notes</label>
                                        <input type="text" id="bulkFollowupNotes" placeholder="e.g., Booster needed">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="bulkNotes">Notes</label>
                            <textarea id="bulkNotes" rows="2" placeholder="Additional notes..."></textarea>
                        </div>

                        <div class="step-actions">
                            <button type="button" class="btn-secondary" id="btnBulkBack">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-save"></i> Save All Records
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Mark Task Complete Modal -->
    <div id="completeTaskModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" data-modal="completeTaskModal">&times;</span>
            <h2><i class="fas fa-check-circle"></i> Mark Task Complete</h2>
            <form id="completeTaskForm">
                <input type="hidden" id="completeTaskId">
                
                <div class="task-summary" id="completeTaskSummary">
                    <!-- Task details will be shown here -->
                </div>

                <div class="form-group">
                    <label for="completeDate">Completion Date *</label>
                    <input type="date" id="completeDate" required>
                </div>

                <div class="form-group">
                    <label for="completeMedication">Medication/Vaccine</label>
                    <input type="text" id="completeMedication">
                </div>

                <div class="form-group">
                    <label for="completeDosage">Dosage</label>
                    <input type="text" id="completeDosage">
                </div>

                <div class="form-row three-col">
                    <div class="form-group">
                        <label for="completeWithdrawalMeat">Meat (days)</label>
                        <input type="number" id="completeWithdrawalMeat" min="0">
                    </div>
                    <div class="form-group">
                        <label for="completeWithdrawalDairy">Dairy (days)</label>
                        <input type="number" id="completeWithdrawalDairy" min="0">
                    </div>
                    <div class="form-group">
                        <label for="completeWithdrawalEggs">Eggs (days)</label>
                        <input type="number" id="completeWithdrawalEggs" min="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="completeNotes">Notes</label>
                    <textarea id="completeNotes" rows="2"></textarea>
                </div>

                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="completeScheduleFollowup">
                        Schedule another follow-up
                    </label>
                </div>
                <div id="completeFollowupDetails" class="hidden">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="completeFollowupDate">Follow-up Date</label>
                            <input type="date" id="completeFollowupDate">
                        </div>
                        <div class="form-group">
                            <label for="completeFollowupNotes">Follow-up Notes</label>
                            <input type="text" id="completeFollowupNotes">
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" data-modal="completeTaskModal">Cancel</button>
                    <button type="submit" class="btn-success">
                        <i class="fas fa-check"></i> Complete & Create Record
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- View Record Details Modal -->
    <div id="viewRecordModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" data-modal="viewRecordModal">&times;</span>
            <h2><i class="fas fa-file-medical"></i> Health Record Details</h2>
            <div id="viewRecordContent">
                <!-- Record details will be populated here -->
            </div>
            <div class="form-actions">
                <button type="button" class="btn-danger" id="btnDeleteRecord">
                    <i class="fas fa-trash"></i> Delete
                </button>
                <button type="button" class="btn-secondary" id="btnEditRecord">
                    <i class="fas fa-edit"></i> Edit
                </button>
                <button type="button" class="btn-secondary" data-modal="viewRecordModal">Close</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div id="confirmDeleteModal" class="modal">
        <div class="modal-content modal-small">
            <span class="modal-close" data-modal="confirmDeleteModal">&times;</span>
            <h2><i class="fas fa-exclamation-triangle"></i> Confirm Delete</h2>
            <p id="confirmDeleteMessage">Are you sure you want to delete this item? This action cannot be undone.</p>
            <input type="hidden" id="deleteItemId">
            <input type="hidden" id="deleteItemType">
            <div class="form-actions">
                <button type="button" class="btn-secondary" data-modal="confirmDeleteModal">Cancel</button>
                <button type="button" class="btn-danger" id="btnConfirmDelete">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>

 <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script src="js/firebase-config.js"></script>
    <script src="js/shared.js"></script>
    <script src="js/nav.js"></script>
    <script src="js/health.js"></script>
</body>
</html>